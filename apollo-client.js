import { ApolloClient, createHttpLink, InMemoryCache } from '@apollo/client';
import { setContext } from '@apollo/client/link/context';

const httpLink = createHttpLink({
  uri: 'https://api-ap-northeast-1.graphcms.com/v2/cjqxhy3af88o801dnxok0ru3c/master',
});

const authLink = setContext((_, { headers }) => {
  // get the authentication token from local storage if it exists
  const token = 'eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MTE2NjIzMzcsImF1ZCI6WyJodHRwczovL2FwaS1hcC1ub3J0aGVhc3QtMS5ncmFwaGNtcy5jb20vdjIvY2pxeGh5M2FmODhvODAxZG54b2swcnUzYy9tYXN0ZXIiLCJodHRwczovL21hbmFnZW1lbnQtbmV4dC5ncmFwaGNtcy5jb20iXSwiaXNzIjoiaHR0cHM6Ly9tYW5hZ2VtZW50LmdyYXBoY21zLmNvbS8iLCJzdWIiOiJjZGQ1ZjFjZi1lMjYzLTRlNzktOTViYi03Y2U4MjU4MTkwODIiLCJqdGkiOiJja2tkeTU2cDUydHN3MDF4c2ZqN3Q4dWtsIn0.3M8AGRIDJA4Ij20v9yvl2N6HhQMcJ9jpSgZ3ONNhCnKYrTZhYKSM0mkEEfISEfs41meULktn63BFUI4bRbeb-jDhUBu_XZascKfyAP-x62KJoX5tp9bMZ8wiEtZMoWpwU5jGLAX_wgy3Uied61Ikn2Cnn7HXmPwCz_R5G4RHFS4RzwJt3HLB04FLIktxU4-kWwORN4_TANiDK97IWgfRGLyQEjmWQWTL-2DhR_oh_MYyF0MgUgMSJOfLuX7JZuWGGeKiPWBinqM5fXQZqGK5qVmbnW9QASsdYd-ECOHstp5N498hnyn-Aaf1pjy4uUCB50zrhHF7UdpiNJIDizU07VynWOys-ELGhecMop75RppSNOLwKz-Xo3P0Er6t9LHjf0KK9eG8r5Fmvd3Kz4BuawKyb_PK0Z-cVVcDzCID2c9xrx_9JKK33UqrvTUY_MZZGPYBRBbxgBmwdZuzzVJZte61gv3pcfnhN_beVwiuElVAR0Cv7RYt5vsJsxeJw0d9nsp1GN2nS0FfJuP5ZOCF8LIp5w-womuSm_bfuys8hkOU-r4UETO972BBnIJTwj7_K0rsD5WlvNwU1JhPfor446tXRDmfuyBIJE1ybEkG-4sOD0BuvnXNRsDJ6Qz2-95ofM86911JIA4BNJNaB2s-AwAcnK7502Wr7ZyO3WJCS6I';
  // set to localStorage
  // window.localStorage.setItem('token', 'eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MTE2NjIzMzcsImF1ZCI6WyJodHRwczovL2FwaS1hcC1ub3J0aGVhc3QtMS5ncmFwaGNtcy5jb20vdjIvY2pxeGh5M2FmODhvODAxZG54b2swcnUzYy9tYXN0ZXIiLCJodHRwczovL21hbmFnZW1lbnQtbmV4dC5ncmFwaGNtcy5jb20iXSwiaXNzIjoiaHR0cHM6Ly9tYW5hZ2VtZW50LmdyYXBoY21zLmNvbS8iLCJzdWIiOiJjZGQ1ZjFjZi1lMjYzLTRlNzktOTViYi03Y2U4MjU4MTkwODIiLCJqdGkiOiJja2tkeTU2cDUydHN3MDF4c2ZqN3Q4dWtsIn0.3M8AGRIDJA4Ij20v9yvl2N6HhQMcJ9jpSgZ3ONNhCnKYrTZhYKSM0mkEEfISEfs41meULktn63BFUI4bRbeb-jDhUBu_XZascKfyAP-x62KJoX5tp9bMZ8wiEtZMoWpwU5jGLAX_wgy3Uied61Ikn2Cnn7HXmPwCz_R5G4RHFS4RzwJt3HLB04FLIktxU4-kWwORN4_TANiDK97IWgfRGLyQEjmWQWTL-2DhR_oh_MYyF0MgUgMSJOfLuX7JZuWGGeKiPWBinqM5fXQZqGK5qVmbnW9QASsdYd-ECOHstp5N498hnyn-Aaf1pjy4uUCB50zrhHF7UdpiNJIDizU07VynWOys-ELGhecMop75RppSNOLwKz-Xo3P0Er6t9LHjf0KK9eG8r5Fmvd3Kz4BuawKyb_PK0Z-cVVcDzCID2c9xrx_9JKK33UqrvTUY_MZZGPYBRBbxgBmwdZuzzVJZte61gv3pcfnhN_beVwiuElVAR0Cv7RYt5vsJsxeJw0d9nsp1GN2nS0FfJuP5ZOCF8LIp5w-womuSm_bfuys8hkOU-r4UETO972BBnIJTwj7_K0rsD5WlvNwU1JhPfor446tXRDmfuyBIJE1ybEkG-4sOD0BuvnXNRsDJ6Qz2-95ofM86911JIA4BNJNaB2s-AwAcnK7502Wr7ZyO3WJCS6I');
  // return the headers to the context so httpLink can read them
  return {
    headers: {
      ...headers,
      authorization: token ? `Bearer ${token}` : "",
    }
  }
});

const client = new ApolloClient({
  link: authLink.concat(httpLink),
  cache: new InMemoryCache()
});

export default client;